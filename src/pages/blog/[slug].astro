---
import { getPosts, getImage } from "../../services/blogwp";
import Hero from "../../components/Hero.astro";
import { formatDate } from "../../utils/functions";
import BlogLayout from "../../layouts/BlogLayout.astro";

const { slug } = Astro.params;
let { image } = Astro.props;

let res = await fetch(
  `https://asisjuridica.com/admin/wp-json/wp/v2/posts?slug=${slug}`,
);
let [post] = await res.json();

// The getStaticPaths() is required for static Astro sites.
// If using SSR, you will not need this function.
export async function getStaticPaths() {
  let posts = await getPosts();

  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post: post },
  }));
}

image = await getImage(post.featured_media);
---

<!-- <Layout title={post.title.rendered}> -->
<BlogLayout>
  <div class="blog-hero" slot="hero">
    <Hero title1={post.title.rendered} haveButtons={false} url={image} />
  </div>
  <div slot="content" class="blog-details-wrap">
    <div class="details__content pb-30">
      <div class="meta-info">
        <ul>
          <li>
            <i class="fal fa-eye"></i> 100 Views
          </li>
          <li>
            <i class="fal fa-calendar-alt"></i>
            {formatDate(post.date)}
          </li>
        </ul>
      </div>
      <Fragment set:html={post.content.rendered} />
      <div class="row">
        <!-- <div class="col-xl-12 col-md-12">
          <div class="post__tag">
            <h5>Releted Tags</h5>
            <ul>
              <li>
                <a href="#">organic</a>
              </li>
              <li>
                <a href="#">Foods</a>
              </li>
              <li>
                <a href="#">tasty</a>
              </li>
            </ul>
          </div>
        </div>
      </div> -->
      </div>
      <!-- <div class="posts_navigation pt-35 pb-35">
      <div class="row align-items-center">
        <div class="col-xl-4 col-md-5">
          <div class="prev-link">
            <span>Prev Post</span>
            <h4>
              <a href="#">Tips Minimalist</a>
            </h4>
          </div>
        </div>
        <div class="col-xl-4 col-md-2 text-left text-md-center">
          <a href="blog.html" class="blog-filter">
            <img src="img/icon/c_d01.png" alt="" />
          </a>
        </div>
        <div class="col-xl-4 col-md-5">
          <div class="next-link text-left text-md-right">
            <span>next Post</span>
            <h4>
              <a href="#">Less Is More</a>
            </h4>
          </div>
        </div>
      </div>
    </div> -->
    </div>
  </div>
</BlogLayout>
